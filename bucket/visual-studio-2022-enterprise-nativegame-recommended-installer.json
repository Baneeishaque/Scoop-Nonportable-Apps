{
    "version": "17.10.4",
    "description": "Visual Studio Enterprise is a powerful, comprehensive IDE for developers designing, building, testing, and deploying complex applications for any platformâ€”including the Microsoft stack. Workload Formal Name : game development with c++, Workload Description : use the full power of c++ to build professional games powered by directx, unreal, or cocos2d.",
    "homepage": "https://visualstudio.microsoft.com/vs/",
    "license": "Freemium",
    "url": "https://aka.ms/vs/17/release/vs_enterprise.exe",
    "hash": "c2ce3760f11eb4ce723831409ce88476ab7a7c68d02ec0d3419bb9c028e2d878",
    "installer": {
        "args": [
            "--add=Microsoft.VisualStudio.Workload.nativegame;includeRecommended",
            "--removeOos=true",
            "--passive",
            "--norestart",
            "--wait"
        ],
        "keep": true
    },
    "uninstaller": {
        "script": [
            "function Clear-VisualStudio {",
            "Start-Process -FilePath \"$dir\\vs_enterprise.exe\" -ArgumentList \"uninstall\", \"--channelId=VisualStudio.17\", \"--productId=Microsoft.VisualStudio.Product.Enterprise\", \"--passive\", \"--norestart\", \"--wait\" -Wait",
            "$installedVisualStudioPreviewWorkloads = & \"$(scoop prefix scoop)\\bin\\scoop.ps1\" list | Select-String -Pattern '(?<visualStudioWorkloadApp>visual-studio-2022-preview-enterprise-(?<visualStudioWorkloadInternalName>[a-z]+)(?<vSWorkloadAppRecommendedVariant>-recommended)?(?<vSWorkloadAppFullVariant>-full)?-installer)' | ForEach-Object -Process { $_.Matches }",
            "if ($installedVisualStudioPreviewWorkloads.Count -eq 0){",
            "Start-Process -FilePath \"${Env:ProgramFiles(x86)}\\Microsoft Visual Studio\\Installer\\vs_installer.exe\" -ArgumentList \"/uninstall\" -Wait",
            "Remove-Item \"$([System.Environment]::GetFolderPath('commonstartmenu'))\\Programs\\Visual Studio Installer.lnk\"",
            "}",
            "}",
            "$matchResult = Select-String -InputObject $app -Pattern '(?<visualStudioWorkloadApp>visual-studio-2022-enterprise-(?<visualStudioWorkloadInternalName>[a-z]+)(?<vSWorkloadAppRecommendedVariant>-recommended)?(?<vSWorkloadAppFullVariant>-full)?-installer)' | ForEach-Object -Process { $_.Matches }",
            "$workloadInternalName = $matchResult.Groups[2].Value",
            "$isIncludeRecommended = $matchResult.Groups[3].Success",
            "$isIncludeOptional = $matchResult.Groups[4].Success",
            "Start-Process -FilePath \"$dir\\vs_enterprise.exe\" -ArgumentList \"--remove=Microsoft.VisualStudio.Workload.$workloadInternalName$($isIncludeRecommended ? \";includeRecommended\":$null)$($isIncludeOptional ? \";includeOptional\":$null)\", \"--channelId=VisualStudio.17\", \"--productId=Microsoft.VisualStudio.Product.Enterprise\", \"--passive\", \"--norestart\", \"--wait\" -Wait",
            "$installedVisualStudioWorkloads = & \"$(scoop prefix scoop)\\bin\\scoop.ps1\" list | Select-String -Pattern '(?<visualStudioWorkloadApp>visual-studio-2022-enterprise-(?<visualStudioWorkloadInternalName>[a-z]+)(?<vSWorkloadAppRecommendedVariant>-recommended)?(?<vSWorkloadAppFullVariant>-full)?-installer)' | ForEach-Object -Process { $_.Matches }",
            "if ($cmd -ceq 'uninstall') {",
            "if ($installedVisualStudioWorkloads -is [System.Text.RegularExpressions.Group]) {",
            "Clear-VisualStudio",
            "}",
            "}",
            "elseif ($cmd -ceq 'update') {",
            "if ($installedVisualStudioWorkloads -is [System.Text.RegularExpressions.Group]) {",
            "Clear-VisualStudio",
            "}",
            "else {",
            "$otherInstalledVisualStudioWorkloads = $installedVisualStudioWorkloads | Where-Object -Property Value -CNE $app",
            "$otherInstalledVisualStudioWorkloads | ForEach-Object -Process { scoop uninstall $_.Value }",
            "Clear-VisualStudio",
            "$isShowManifestEnabled = scoop config show_manifest",
            "if ($isShowManifestEnabled){",
            "scoop config show_manifest $false",
            "}",
            "$otherInstalledVisualStudioWorkloads | ForEach-Object -Process { scoop install \"$bucket/$($_.Value)\" }",
            "if ($isShowManifestEnabled){",
            "scoop config show_manifest $true",
            "}",
            "}",
            "}"
        ]
    },
    "checkver": {
        "url": "https://learn.microsoft.com/en-us/visualstudio/releases/2022/release-notes",
        "regex": ">Visual Studio 2022 version ([\\d.]+)<"
    },
    "autoupdate": {
        "url": "https://aka.ms/vs/17/release/vs_enterprise.exe"
    }
}
